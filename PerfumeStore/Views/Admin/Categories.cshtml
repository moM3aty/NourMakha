@model List<PerfumeStore.Models.Category>
@{
    ViewData["Title"] = System.Globalization.CultureInfo.CurrentCulture.Name.StartsWith("ar") ? "إدارة الأقسام" : "Manage Categories";
    var isArabic = System.Globalization.CultureInfo.CurrentCulture.Name.StartsWith("ar");
    Layout = "_AdminLayout";
}

<div class="page-header animate-fade-up">
    <div class="header-left">
        <h1>@ViewData["Title"]</h1>
        <p>@(isArabic ? "إدارة وتصنيف المنتجات في المتجر" : "Manage and classify store products")</p>
    </div>
    <div class="header-right">
        <a href="/Admin/CreateCategory" class="btn btn-primary">
            <i class="fas fa-plus"></i>
            @(isArabic ? "إضافة قسم جديد" : "Add New Category")
        </a>
    </div>
</div>

<div class="card animate-fade-up delay-1">
    <div class="card-body">
        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>@(isArabic ? "الترتيب" : "Order")</th>
                        <th>@(isArabic ? "اسم القسم (عربي)" : "Name (AR)")</th>
                        <th>@(isArabic ? "اسم القسم (EN)" : "Name (EN)")</th>
                        <th>@(isArabic ? "عدد المنتجات" : "Products Count")</th>
                        <th>@(isArabic ? "الحالة" : "Status")</th>
                        <th>@(isArabic ? "الإجراءات" : "Actions")</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var cat in Model.OrderBy(c => c.DisplayOrder))
                    {
                        <tr>
                            <td><span class="coupon-code">#@cat.DisplayOrder</span></td>
                            <td style="font-weight: 600;">@cat.NameAr</td>
                            <td style="color: var(--text-secondary);">@cat.Name</td>
                            <td><span class="status-badge" style="background: rgba(52, 152, 219, 0.1); color: #3498db; border-color: rgba(52, 152, 219, 0.2);">@cat.Products.Count</span></td>
                            <td>
                                <span class="status-badge @(cat.IsActive ? "active" : "inactive")">
                                    @(cat.IsActive ? (isArabic ? "نشط" : "Active") : (isArabic ? "معطل" : "Disabled"))
                                </span>
                            </td>
                            <td>
                                <div class="action-btns">
                                    <a href="/Admin/EditCategory/@cat.Id" class="action-btn" title="@(isArabic ? "تعديل" : "Edit")">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    @if (cat.Id > 5)
                                    { @* منع حذف الأقسام الأساسية المزروعة *@
                                        <button class="action-btn delete" onclick="deleteCategory(@cat.Id)" title="@(isArabic ? "حذف" : "Delete")">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    }
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function deleteCategory(id) {
        if(confirm('@(isArabic ? "هل أنت متأكد من حذف هذا القسم؟" : "Are you sure you want to delete this category?")')) {
            // تنفيذ الحذف عبر POST
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = `/Admin/DeleteCategory/${id}`;
            document.body.appendChild(form);
            form.submit();
        }
    }
</script>