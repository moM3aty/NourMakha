@{
    ViewData["Title"] = System.Globalization.CultureInfo.CurrentCulture.Name == "ar" ? "التقارير" : "Reports";
    var isArabic = System.Globalization.CultureInfo.CurrentCulture.Name == "ar";
    Layout = "_AdminLayout";
}

<div class="page-header">
    <div class="header-left">
        <h1>@(isArabic ? "التقارير والإحصائيات" : "Reports & Analytics")</h1>
    </div>
</div>

<!-- Date Filter -->
<div class="card filter-card">
    <form method="get" class="date-filter">
        <div class="filter-group">
            <label>@(isArabic ? "من تاريخ" : "From Date")</label>
            <input type="date" name="startDate" value="DateTime.Today.AddMonths(-1).ToString("yyyy-MM-dd")" />
        </div>
        <div class="filter-group">
            <label>@(isArabic ? "إلى تاريخ" : "To Date")</label>
            <input type="date" name="endDate" value="DateTime.Today.ToString("yyyy-MM-dd")" />
        </div>
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-filter"></i>
            @(isArabic ? "تصفية" : "Filter")
        </button>
    </form>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon sales">
            <i class="fas fa-dollar-sign"></i>
        </div>
        <div class="stat-info">
            <h3>@(isArabic ? "إجمالي المبيعات" : "Total Sales")</h3>
            <p class="stat-value">$24,500</p>
            <span class="stat-change positive">+12.5%</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon orders">
            <i class="fas fa-shopping-cart"></i>
        </div>
        <div class="stat-info">
            <h3>@(isArabic ? "الطلبات" : "Orders")</h3>
            <p class="stat-value">156</p>
            <span class="stat-change positive">+8.2%</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon products">
            <i class="fas fa-box"></i>
        </div>
        <div class="stat-info">
            <h3>@(isArabic ? "المنتجات المباعة" : "Products Sold")</h3>
            <p class="stat-value">342</p>
            <span class="stat-change positive">+15.3%</span>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon customers">
            <i class="fas fa-users"></i>
        </div>
        <div class="stat-info">
            <h3>@(isArabic ? "متوسط قيمة الطلب" : "Avg. Order Value")</h3>
            <p class="stat-value">$157</p>
            <span class="stat-change negative">-2.1%</span>
        </div>
    </div>
</div>

<div class="reports-grid">
    <!-- Sales Chart -->
    <div class="card chart-card">
        <div class="card-header">
            <h3>@(isArabic ? "المبيعات الشهرية" : "Monthly Sales")</h3>
        </div>
        <div class="card-body">
            <canvas id="salesChart" height="300"></canvas>
        </div>
    </div>
    
    <!-- Orders by Status -->
    <div class="card">
        <div class="card-header">
            <h3>@(isArabic ? "الطلبات حسب الحالة" : "Orders by Status")</h3>
        </div>
        <div class="card-body">
            <canvas id="statusChart" height="300"></canvas>
        </div>
    </div>
    
    <!-- Sales by Category -->
    <div class="card">
        <div class="card-header">
            <h3>@(isArabic ? "المبيعات حسب الفئة" : "Sales by Category")</h3>
        </div>
        <div class="card-body">
            <canvas id="categoryChart" height="300"></canvas>
        </div>
    </div>
    
    <!-- Top Products -->
    <div class="card">
        <div class="card-header">
            <h3>@(isArabic ? "أفضل المنتجات" : "Top Products")</h3>
        </div>
        <div class="card-body">
            <div class="top-products-list">
                <div class="top-product-item">
                    <span class="rank">1</span>
                    <span class="name">Oud Royal</span>
                    <span class="sales">$4,500</span>
                </div>
                <div class="top-product-item">
                    <span class="rank">2</span>
                    <span class="name">Amber Nights</span>
                    <span class="sales">$3,800</span>
                </div>
                <div class="top-product-item">
                    <span class="rank">3</span>
                    <span class="name">Rose Mystique</span>
                    <span class="sales">$2,900</span>
                </div>
                <div class="top-product-item">
                    <span class="rank">4</span>
                    <span class="name">Leather Prestige</span>
                    <span class="sales">$2,400</span>
                </div>
                <div class="top-product-item">
                    <span class="rank">5</span>
                    <span class="name">Blue Ocean</span>
                    <span class="sales">$1,800</span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.filter-card {
    margin-bottom: 1.5rem;
}

.date-filter {
    display: flex;
    gap: 1rem;
    align-items: flex-end;
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.filter-group label {
    font-size: 0.875rem;
    color: #6c6c7c;
}

.filter-group input {
    padding: 0.75rem;
    background: rgba(15, 15, 26, 0.8);
    border: 1px solid rgba(212, 175, 55, 0.2);
    border-radius: 8px;
    color: #fff;
}

.reports-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
}

.chart-card {
    grid-column: 1 / -1;
}

.top-products-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.top-product-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
}

.top-product-item .rank {
    width: 30px;
    height: 30px;
    background: rgba(212, 175, 55, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: #d4af37;
}

.top-product-item .name {
    flex: 1;
}

.top-product-item .sales {
    font-weight: 600;
    color: #d4af37;
}

@@media (max-width: 992px) {
    .date-filter {
        flex-wrap: wrap;
    }
    
    .reports-grid {
        grid-template-columns: 1fr;
    }
}
</style>

@section Scripts {
    <script>
        // Sales Chart
        new Chart(document.getElementById('salesChart'), {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: '@(isArabic ? "المبيعات" : "Sales")',
                    data: [12000, 15000, 18000, 22000, 19000, 25000, 28000, 24000, 26000, 30000, 28000, 32000],
                    borderColor: '#d4af37',
                    backgroundColor: 'rgba(212, 175, 55, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.1)' } },
                    x: { grid: { display: false } }
                }
            }
        });
        
        // Status Chart
        new Chart(document.getElementById('statusChart'), {
            type: 'doughnut',
            data: {
                labels: ['@(isArabic ? "تم التسليم" : "Delivered")', '@(isArabic ? "قيد الشحن" : "Shipped")', '@(isArabic ? "قيد المعالجة" : "Processing")', '@(isArabic ? "قيد الانتظار" : "Pending")'],
                datasets: [{
                    data: [65, 20, 10, 5],
                    backgroundColor: ['#2ecc71', '#e67e22', '#9b59b6', '#f1c40f']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });
        
        // Category Chart
        new Chart(document.getElementById('categoryChart'), {
            type: 'bar',
            data: {
                labels: ['@(isArabic ? "رجالي" : "Men")', '@(isArabic ? "نسائي" : "Women")', '@(isArabic ? "للجنسين" : "Unisex")', '@(isArabic ? "فاخر" : "Luxury")'],
                datasets: [{
                    label: '@(isArabic ? "المبيعات" : "Sales")',
                    data: [8500, 7200, 4800, 4000],
                    backgroundColor: '#d4af37'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.1)' } },
                    x: { grid: { display: false } }
                }
            }
        });
    </script>
}
